# 3/15
* 관계형 데이터 모델
  - 오라클디비 사용을 권장! -> 프로젝트
* 테이블 -> 릴레이션

P.3
1. [설계를 위한 준비] - 관계 데이터 모델과 체약조건
2. 기획보고서를 보고 [업무분석] -> 화면 구상 및 정의
3. [논리적 DB설계]
4. [물리적 DB설계]
5. [데이터베이스 구축]

# 2장 관계 데이터 모델과 제약조건
* 관계 데이터 모델: 지금까지 제안된 데이터 모델들 중에서 가장 개념이 단순한 데이터 모델의 하나

* 릴레이션의 키
  - 각 투플을 고유하게 식별할 수 있는 하나 이상의 애트리뷰트들의 모임
* 키의 종류
  * 수퍼키: 한 릴레이션 내의 특정 투플을 고유하게 식별하는 하나의 애트리뷰트 또는 애트리뷰트들의 집합
    - 투플들을 고유하게 식별하는데 꼭 필요하지 않은 애트리뷰트들을 포함할 수 있음
  * 후보키: 각 투플을 고유하게 식별하는 최소한의 애트리뷰트들의 모임
    - 모든 릴레이션에는 최소한 한 개 이상의 후보 키가 있음
    - 후보키도 두개 이상의 애트리뷰트로 이루어 질 수 있는 데 이러한 경우 "복합키"라고 함
  * 기본키: 한 릴레이션에서 후보키가 두 개 이상 있으면 설계자 또는 데이터베이스 관리자가 이들 중에서 하나를 기본키로 선정
    - 자연스로운 기본키를 찾을 수 없는 경우에는 레코드 번호와 같이 종종 인위적인 키 애트리뷰트를 릴레이션에 추가할 수 있음
  * 대체키: 기본키가 아닌 후보키
    - 후보키가 여러 개 있을 때 선정된 기본키를 재외한 모든 후보키
  * 외래키: 어떤 릴레이션의 기본키를 참조하는 애트리뷰트
    - 관계 데이터베이스에서 릴레이션들 간의 관계를 나타내기 위해서 사용
    - 외래키 애트리뷰트는 참조되는 릴레이션의 기본키와 동일한 도메일을 가져야함
    - 자신이 속한 릴레이션의 기본키의 구성요소가 되거나 되지 않을 수 있음

* 데이터 무결성 : 데이터의 결점이 없음
  - 데이터의 정확성 또는 유효성을 의미
  - 일관된 데이터베이스 상태를 정의하는 규칙들을 묵시적으로 또는 명시적으로 정의
  - 데이터베이스가 갱신될 때 DBMS가 자동적으로 일관성 조건을 검사하므로 응용 프로그램들은 일관성 조건을 검사할 필요가 없음

* 무결성 제약조건
  * 도메인 제약조건
    - 각 애트리뷰트 값이 반드지 원자값일 것
    - 애트리뷰트 값이 디폴트 값, 가능한 값들의 범위 등을 지정할 수 있음
    - 데이터 형식을 통해 값들의 유형을 제한하고, check 제약 조건을 통해 값들의 범위를 제한할 수 있음

  * 키 제약조건
    - 키 애트리뷰트에 중복된 값이 존재해서는 안됨
      - 키가 되었을 때 중복되면 안된다 -> 당연한 말

  * 기본키와 엔티티 무결성 제약조건
    - 릴레이션의 기본키를 구성하는 어떤 애트리뷰트도 널값을 가질 수 없음
      => 키는 NULL값을 가질 수 없다!
    - 대체키에는 적용되지 않음
      => 키가 아니기 때문에 NULL 허용
    - 사용자는 릴레이션을 생성하는 데이터 정의문에서 어떤 애트리뷰트가 릴레이션이 기본키의 구성요소인가를 DBMS에게 알려줌

  * 외래 키와 참조 무결성 제약조건(referential integrity constraint)
    - 참조 무결성 제약조건은 두 릴레이션의 연관된 투플들 사이의 일관성을 유지하는데 사용됨
    - 관계 데이터베이스가 릴레이션들로만 이루어지고, 릴레이션 사이의 관계들 이 다른 릴레이션의 기본키를 참조하는 것을 기반으로 하여 묵시적으로 표현되기 때문에 외래키의 개념이 중요
    - 릴레이션 R2의 외래키가 릴레이션 R1의 기본키를 참조할 때 *참조 무결성 제약조건*은 아래의 두 조건 중 하나가 성립되면 만족됨
      **참조 무결성 제약조건** 
      - 외래키의 값은 R1의 어떤 투플의 기본 키 값과 같다 => 테이블 명은 달라도 됨
        : DNO의 값이 DEPTNO의 값에 무조건 있어야 한다 [cf: p.37]
      - 외래키가 자신을 포함하고 있는 릴레이션의 기본키를 구성하고 있지 않으면 널값을 가진다
        : DNO(외래키) / EMPLOYEE 릴레이션(자신을 포함하고 있는 릴레이션)의 기본키가 아니라면(= DNO가 기본키가 아니라면) NULL값을 가짐
          -> 신입사원의 경우 부서 배정받지 못했기 때문에, DNO가 없음 -> DNO = NULL
          
  *무결성 제약조건의 유지* 
    - 데이터베이스에 대한 갱신 연산은 삽입, 삭제, 수정 연산으로 구분함
    - DBMS는 각각의 갱신 연산에 대하여 데이터베이스가 무결성 제약조건들을 만족하도록 필요한 조치를 취함
    - DBMS는 외래 키가 갱신되거나, 참조된 기본 키가 갱신되었을 때 참조 무결성 제약조건이 위배되지 않도록 해야함
    - EMPLOYEE 릴레이션의 DNO 애트리뷰트가 DEPARTMENT 릴레이션의 기본키인 DEPTNO를 참조하는 외래키이므로, DEPARTMENT를 참조된 릴레이션, EMPLOYEE를 참조하는 릴레이션이라 함
      [cf: ch02 - P.36]

    *삽입연산*
      - 참조되는 릴레이션에 새로운 투플이 삽입되면 *참조 무결성 제약조건*은 위배되지 않음
        : 참조되는 릴레이션에 새로운 데이터가 삽입되어도, 참조하는 릴레이션은 변경되지않음!!
      - DEPARTMENT에 새로 삽입되는 투플의 기본 키 애트리뷰트의 값에 따라서는 *도메인 제약조건*, *키 제약조건*, *엔티티 무결성 제약조건* 등을 위배할 수 있음
        : DEPTNO에 같은 값이 들어감 - 키 제약조건 위배
      - 참조하는 릴레이션에 새로운 투플을 삽입할 때는 도메인 제약조건, 키 제약 조건, 엔티티 무결성 제약조건 외에 참조 무결성 제약조건도 위배할 수 있음
        : EMPLOYEE 릴레이션에 (4325, 오혜원, 6)이라는 투플을 삽입하면 참조 무결성 제약조건을 위배하게 됨
        : EMPLOYEE 릴레이션에 (7379, 오혜원, 50)이라는 투플을 삽입하면 키 제약 조건을 위배하게 됨
        : EMPLOYEE 릴레이션에 (null, 오혜원, 50)이라는 투플을 삽입하면 엔티티 무결성 제약 조건을 위배하게 됨


    *삭제연산*
      - 참조하는 릴레이션에서 투플이 삭제되면 도메인 제약조건, 키 제약조건, 엔 티티 무결성 제약조건, 참조 무결성 제약조건 등 모든 제약조건을 위배하지 않음
      - 참조되는 릴레이션에서 투플이 삭제되면 참조 무결성 제약조건을 위배하는 경우가 생기거나 생기지 않을 수 있음
        : DEPARTMENT 릴레이션에서 네 번째 투플인 (40, 생산, 8)을 삭제하더라도 참조 무결성 제약조건을 위배하지 않음
          -> 참조하는 릴레이션에서 외래키의 값이 해당하지 않아, 참조 무결성 제약조건을 위해하지 않음.
        : DEPARTMENT 릴레이션에서 세 번째 투플인 (30, 영업, 7)를 삭제하면 참조 무결성 제약조건을 위배하게 됨
    